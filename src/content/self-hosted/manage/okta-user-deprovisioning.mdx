---
title: Okta User Deprovisioning
description: Automatically deprovision okteto users when they are removed from Okta
sidebar_label: Okta User Deprovisioning
id: okta-user-deprovisioning
---

If you have configured Okta as your identity provider for Okteto, you can automatically deprivision users once they are deleted in Okta.

Okteto provides an endpoint to receive okta [event hooks](https://help.okta.com/en-us/content/topics/automation-hooks/event-hooks-main.htm) that will automatically deprovision users when they are deleted or deactivated from Okta.

:::note
Only the deactive and delete events are supported. If more events are added they will be ignored.
:::

## Configuration

Within you Okta management console, navigate to `Workflows -> Event Hooks` and create a new event hook with the following configuration:


- **Name**: A descriptive name for the event hook
- **URL**: https://okteto.your-domain.com/api/okta
- **Authentication Field**: It must be set to `Authorization` as this is the field that okteto uses to authenticate the request
- **Authentication Secret**: Provide a secret value that will be used to authenticate the request. This value should match the value provided in the oktato helm config (more info below)
- **Events**: Select the `User Deactivated` and/or `User Deleted` events

Okteto makes no disntiction between the `User Deactivated` and `User Deleted` events. Both will trigger the deprovisioning of the user so you can select the one that better fits your use case or both. If both are selected and given that a user need to first be deactived in Okta before being deleted, the `User Deleted` event will just be skipped.

<p align="center">
  <Image
    src={require("@site/static/img/okta-user-deprovision.png").default}
    alt="Okta User Deprovision Configuration"
  />
</p>

Okta requires verifying ownership of the URL before sending events. This is a special one-time event that okta sends to the webhook and that Okteto understands.

To be able to receive this event and all subsequent delete and deactivate events, you need to enable the webhook in the oktato helm file and provide the same secret used in the event hook configuration:

```yaml
okta:
  events:
    enabled: true
    authSecret: my-secret
```

Once your event hook is created, and you okteto instance configured to receive the events, you can activate the webhook through the okta admin console:


<p align="center">
  <Image
    src={require("@site/static/img/okta-user-deprovision-verify.png").default}
    alt="Okta User Deprovision webhook verification"
  />
</p>


Once the webhook is verified, you will start receiving the `User Deactivated` and `User Deleted` events in your okteto instance. Okteto will automatically deprovision these user from the system.

Events sent to the webhook appear in the `Reports -> System Log` tab which can be useful for troubleshooting.

:::note
This feature is compatible with Okteto Chart 1.29 and higher. If you get a 404 error during the verification process make sure that you okteto instance is at least 1.29 and that `okta.events.enabled` is set to `true` in the helm configuration.
:::


